<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Traffic Lights classification | Main page</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Machine Learning project">
    <meta name="generator" content="Hugo 0.88.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
<link rel="stylesheet" href="https://spyroy.github.io/Portfolio/ananke/css/main.min.css" >




    
      

    

    
    
    <meta property="og:title" content="Traffic Lights classification" />
<meta property="og:description" content="Machine Learning project" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://spyroy.github.io/Portfolio/post/project-13/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-07-16T11:00:59-04:00" />
<meta property="article:modified_time" content="2021-07-16T11:00:59-04:00" /><meta property="og:site_name" content="Main page" />

<meta itemprop="name" content="Traffic Lights classification">
<meta itemprop="description" content="Machine Learning project"><meta itemprop="datePublished" content="2021-07-16T11:00:59-04:00" />
<meta itemprop="dateModified" content="2021-07-16T11:00:59-04:00" />
<meta itemprop="wordCount" content="1162">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Traffic Lights classification"/>
<meta name="twitter:description" content="Machine Learning project"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://miro.medium.com/max/1200/1*cG6U1qstYDijh9bPL42e-Q.jpeg');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://spyroy.github.io/Portfolio/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Main page
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://spyroy.github.io/Portfolio/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://spyroy.github.io/Portfolio/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://spyroy.github.io/Portfolio/post/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      







<a href="https://www.linkedin.com/in/matan-greenberg/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/spyroy" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Traffic Lights classification</h1>
          
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Machine Learning project
            </h2>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://spyroy.github.io/post/project-13/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://spyroy.github.io/post/project-13/&amp;text=Traffic%20Lights%20classification" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://spyroy.github.io/post/project-13/&amp;title=Traffic%20Lights%20classification" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Traffic Lights classification</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2021-07-16T11:00:59-04:00">July 16, 2021</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h1 id="introduction">Introduction</h1>
<p>In this project, we wanted to classify two classes – pedestrian traffic lights and vehicle traffic lights.
To so we used the data from Kaggle: <a href="https://www.kaggle.com/hj23hw/pedestrian-augmented">https://www.kaggle.com/hj23hw/pedestrian-augmented</a>traffic-light-dataset.
The project goal was to classify pedestrian traffic lights and vehicle traffic lights, some uses we
thought can be useful from this project is for automation for cars so it will know the difference
between the two types of traffic lights, it is not a complete model but can be used as features
extractor for a more complicated model.
Our goal was to experience the algorithms – CNN, KNN, SVM, Logistic Regression and to analyze the
results, we also wanted to see what happens if we combine all the models together (kind of
Adaboost).
Our data is from various sizes in format JPG, we transformed it to 128x128x3 RGB. In the CNN we
transformed the images to - number_of_samplesX128X128X3, and in all other models to -
number_of_samplesX49152 (128<em>128</em>3).
For better results, we also made some random transformations on the data to make it more diverse,
for example, to invert the image, rotate the image, etc.
When using the Adaboost we gave each model (rule) weight according to its accuracy and predicted
the label of the new image by summing all models predictions multiplied by their weight. If the sum
was greater equal to – 0 then the output is pedestrian, otherwise, it is a vehicle.</p>
<h1 id="struggles--solutions">Struggles &amp; Solutions</h1>
<ol>
<li>Our main struggle in this project was to find enough data, we wanted equal number of images
from pedestrian traffic lights and vehicle traffic lights.
We did not manage to find enough vehicle traffic lights images, so we used 1630 pedestrian traffic
lights and 767 vehicle traffic lights, we trained our model with this as imbalanced data, the results
were not bad – we got 99.6% accuracy on CNN, 97.8% accuracy on KNN, 98.7% accuracy on Logistic
Regression, 98.8% on SVM and 99.2% on the Adaboost.
At first, we tried to find more vehicle traffic lights images, but we did not manage to find data that fit
our purpose.
Secondly, we thought to duplicate images of vehicle traffic lights with transformation for each
image, for example, to invert the image, rotate the image, etc.
Thirdly, we wanted to add bias to images that were classified as vehicle traffic lights due to lack of
data, but we figured out it won&rsquo;t go well because some models can&rsquo;t add bias to the classes such as
KNN because we didn’t even have weights, although we can add weights to the KNN such that the
distance to pedestrian traffic light image will grow with some bias, so if we have two points with
equivalent distance from our point and one is pedestrian and the other is a vehicle the vehicle will
be chosen. But we assumed that this algorithm does not work well.
Eventually, we decided to use less data, we removed pedestrian traffic lights images such that we
have 767 for each class, 1534 images in total.
We chose this solution because we noticed that our data is similar, that is a lot of images look the
same. Although we used a method to transform our data in the code, we still think it is important to
use a variety of images, which this solution gives us by removing images.
The results we got from the balanced data 99.2% accuracy on CNN, 97.4% accuracy on KNN, 97.8%
accuracy on Logistic Regression, 97.9% on SVM, and 98.9% on the &ldquo;Adaboost&rdquo;.</li>
<li>Another problem we had is that in the CNN model the train accuracy was too high (100%)
Most of the time, this can imply that we have overfitting.
We think that the reason for this is that the regularization is too low, and our model is too
complicated.
To solve this problem we added more regularization, it is we increased the dropout layer to 0.6, so
every iteration about 60% of the neurons are dead. This solution decreases the power of the model
and makes it more simple, so our accuracy also decreased but we believe that the model has better
generalization, meaning that for more complicated new data which is not in our dataset it will work
better.
What we learned</li>
<li>How to write the algorithms in Python, we experience the Keras and Sklearn libraries and how to
use them.</li>
<li>SVM and Logistic Regression misclassify the same images but Logistic Regression misclassify
more, we think the reason for that is that both give us some hyperplane to separate the data so it&rsquo;s
reasonable that they both will learn the same hyperplane and that’s why their results are very
similar.</li>
<li>The Adaboost algorithm gives better results than SVM, Logistic Regression, and KNN but not
better than the CNN So for images classification, CNN seemed to be the most efficient model.</li>
<li>The KNN works best for one neighbor because all the images from the same class are similar, this
implies that this model does not good for image classification, also because the distance between
images is ambiguous, for example, if we take one image and blacken some pixels in some position
and in another image we will blacken the same amount of pixels in another position their distance
from the original image will be the same.</li>
<li>We extracted every image that every model misclassified and we saw that there was one image
that all models classified correctly except the CNN, we think that the CNN sometimes has constraints
so he misclassifies simple things that other models can classify correctly.</li>
<li>We also tried our models on new images that were not from our dataset, and the results weren’t
too good, the SVM classified 8/10 images correctly the other models classified 6/10 correctly, and
the Adaboost classified 7/10 correctly.
The Results weren’t so good because our data isn’t reflect the real world good enough, it is too small
and not very diverse.
It should be noted that when we checked the new data we trained the CNN for only 15 iterations
(due to lack of time), a better results might be achived if we trained it for 100 iterations.</li>
<li>All models except CNN transform our images – 128x128x3 to vector of 49152 (128<em>128</em>3),
because similar images with the regular form will still be similar in the vector form which is what we
want.
We also tried the same method for greyscale to see if the representation of an image as vector will
be effected, the results were not good significantly on the dataset, and for the images that were not
from the dataset the CNN got 5/10 compared to 6/10, SVM got 7/10 compared to 8/10, KNN got
5/10 compared to 6/10, Logistic Regression got 7/10 compared to 6/10 and Adaboost got 7/10
compared to 7/10. So we see that for our dataset it gave relatively bad results to the RGB, but it
seemed to be more generalized for images from the real world, and give results similar to the test
results.</li>
</ol>
<p><figure><img src="https://spyroy.github.io/Portfolio/images/accur.png"/>
</figure>

<figure><img src="https://spyroy.github.io/Portfolio/images/accuracy%20with%20greyscale.png"/>
</figure>

<figure><img src="https://spyroy.github.io/Portfolio/images/adaboost%20greyscale.png"/>
</figure>

<figure><img src="https://spyroy.github.io/Portfolio/images/cnn%20greyscale.png"/>
</figure>
</p>
<p><a href="https://github.com/spyroy/machine-learning-project">Full project</a></p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://spyroy.github.io/Portfolio/" >
    &copy;  Main page 2021 
  </a>
    <div>







<a href="https://www.linkedin.com/in/matan-greenberg/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/spyroy" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>

  </body>
</html>
